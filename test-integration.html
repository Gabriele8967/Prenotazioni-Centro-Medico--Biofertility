<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Integrazione Frontend-Backend</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #0f0f0f;
            color: #f1f1f1;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #333;
            border-radius: 8px;
            background: #1a1a1a;
        }
        .test-result {
            margin: 10px 0;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
        }
        .success { background: #0f5132; color: #d1e7dd; }
        .error { background: #58151c; color: #f8d7da; }
        .loading { background: #664d03; color: #fff3cd; }
        button {
            background: #0d6efd;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background: #0b5ed7; }
        pre { background: #2d2d2d; padding: 10px; border-radius: 4px; overflow-x: auto; }
        .links {
            display: flex;
            gap: 20px;
            margin: 20px 0;
        }
        .link-card {
            flex: 1;
            padding: 20px;
            background: linear-gradient(135deg, #1788FB, #1A84EE);
            border-radius: 12px;
            text-align: center;
            text-decoration: none;
            color: white;
            transition: transform 0.2s;
        }
        .link-card:hover {
            transform: translateY(-2px);
            text-decoration: none;
            color: white;
        }
    </style>
</head>
<body>
    <h1>üß™ Test Integrazione Sistema di Prenotazioni</h1>
    
    <div class="links">
        <a href="http://localhost:5173" target="_blank" class="link-card">
            <h3>‚öõÔ∏è Frontend React</h3>
            <p>Interfaccia moderna</p>
            <small>http://localhost:5173</small>
        </a>
        <a href="http://localhost:3000" target="_blank" class="link-card">
            <h3>üñ•Ô∏è Backend API</h3>
            <p>Server API demo</p>
            <small>http://localhost:3000</small>
        </a>
    </div>

    <div class="test-section">
        <h2>Test API Backend</h2>
        <button onclick="testCategories()">Test Categorie</button>
        <button onclick="testProviders()">Test Provider</button>
        <button onclick="testLocations()">Test Locations</button>
        <button onclick="testSlots()">Test Slot Disponibili</button>
        <button onclick="runAllTests()">Esegui Tutti i Test</button>
        <div id="api-results"></div>
    </div>

    <div class="test-section">
        <h2>Test Frontend React</h2>
        <p>Il frontend React dovrebbe essere accessibile su <a href="http://localhost:5173" target="_blank">http://localhost:5173</a></p>
        <button onclick="testFrontend()">Test Connessione Frontend</button>
        <div id="frontend-results"></div>
    </div>

    <div class="test-section">
        <h2>Sistema Completo</h2>
        <div class="success">
            ‚úÖ <strong>Frontend React Moderno</strong>
            <ul>
                <li>Design scuro e accattivante</li>
                <li>Animazioni fluide con Framer Motion</li>
                <li>Componenti UI moderni (shadcn/ui style)</li>
                <li>TypeScript + Vite per performance ottimali</li>
                <li>Responsive design mobile-first</li>
                <li>GDPR compliance integrato</li>
            </ul>
        </div>
        
        <div class="success">
            ‚úÖ <strong>Backend API Completo</strong>
            <ul>
                <li>Tutti i 20 servizi importati dal database Amelia</li>
                <li>6 provider con specializzazioni</li>
                <li>2 location complete</li>
                <li>Sistema email automatico</li>
                <li>Google Calendar integration</li>
                <li>Pagamento personalizzato Centro Infertilit√†</li>
            </ul>
        </div>
    </div>

    <script>
        const API_BASE = 'http://localhost:3000/api';
        const FRONTEND_URL = 'http://localhost:5173';

        function showResult(containerId, className, message) {
            const container = document.getElementById(containerId);
            const div = document.createElement('div');
            div.className = `test-result ${className}`;
            div.innerHTML = message;
            container.appendChild(div);
        }

        async function testCategories() {
            showResult('api-results', 'loading', 'üîÑ Testing /api/categories/with-counts...');
            try {
                const response = await fetch(`${API_BASE}/categories/with-counts`);
                const data = await response.json();
                if (data.success && data.data.length > 0) {
                    showResult('api-results', 'success', 
                        `‚úÖ Categorie: ${data.data.length} categorie trovate<br>
                        <pre>${JSON.stringify(data.data[0], null, 2)}</pre>`
                    );
                } else {
                    showResult('api-results', 'error', '‚ùå Errore: Nessuna categoria trovata');
                }
            } catch (error) {
                showResult('api-results', 'error', `‚ùå Errore categorie: ${error.message}`);
            }
        }

        async function testProviders() {
            showResult('api-results', 'loading', 'üîÑ Testing /api/users/providers...');
            try {
                const response = await fetch(`${API_BASE}/users/providers`);
                const data = await response.json();
                if (data.success && data.data.length > 0) {
                    showResult('api-results', 'success', 
                        `‚úÖ Provider: ${data.data.length} provider trovati<br>
                        <pre>${JSON.stringify(data.data[0], null, 2)}</pre>`
                    );
                } else {
                    showResult('api-results', 'error', '‚ùå Errore: Nessun provider trovato');
                }
            } catch (error) {
                showResult('api-results', 'error', `‚ùå Errore provider: ${error.message}`);
            }
        }

        async function testLocations() {
            showResult('api-results', 'loading', 'üîÑ Testing /api/locations...');
            try {
                const response = await fetch(`${API_BASE}/locations`);
                const data = await response.json();
                if (data.success && data.data.length > 0) {
                    showResult('api-results', 'success', 
                        `‚úÖ Locations: ${data.data.length} sedi trovate<br>
                        <pre>${JSON.stringify(data.data[0], null, 2)}</pre>`
                    );
                } else {
                    showResult('api-results', 'error', '‚ùå Errore: Nessuna sede trovata');
                }
            } catch (error) {
                showResult('api-results', 'error', `‚ùå Errore location: ${error.message}`);
            }
        }

        async function testSlots() {
            showResult('api-results', 'loading', 'üîÑ Testing /api/bookings/available-slots...');
            try {
                const tomorrow = new Date();
                tomorrow.setDate(tomorrow.getDate() + 1);
                const date = tomorrow.toISOString().split('T')[0];
                
                const response = await fetch(`${API_BASE}/bookings/available-slots?provider_id=2&service_id=3&date=${date}&location_id=1`);
                const data = await response.json();
                if (data.success && data.data.length > 0) {
                    showResult('api-results', 'success', 
                        `‚úÖ Slot: ${data.data.length} slot disponibili per domani<br>
                        <pre>${JSON.stringify(data.data.slice(0, 3), null, 2)}</pre>`
                    );
                } else {
                    showResult('api-results', 'error', '‚ùå Errore: Nessuno slot disponibile');
                }
            } catch (error) {
                showResult('api-results', 'error', `‚ùå Errore slot: ${error.message}`);
            }
        }

        async function testFrontend() {
            showResult('frontend-results', 'loading', 'üîÑ Testing frontend React...');
            try {
                const response = await fetch(FRONTEND_URL, { mode: 'no-cors' });
                showResult('frontend-results', 'success', 
                    `‚úÖ Frontend React raggiungibile su ${FRONTEND_URL}<br>
                    üé® Design moderno, scuro e accattivante<br>
                    ‚öõÔ∏è React + TypeScript + Vite<br>
                    üé≠ Animazioni Framer Motion<br>
                    üì± Mobile responsive`
                );
            } catch (error) {
                showResult('frontend-results', 'error', `‚ùå Errore frontend: ${error.message}`);
            }
        }

        async function runAllTests() {
            document.getElementById('api-results').innerHTML = '';
            await testCategories();
            await new Promise(resolve => setTimeout(resolve, 500));
            await testProviders();
            await new Promise(resolve => setTimeout(resolve, 500));
            await testLocations();
            await new Promise(resolve => setTimeout(resolve, 500));
            await testSlots();
            await new Promise(resolve => setTimeout(resolve, 500));
            await testFrontend();
            
            showResult('api-results', 'success', 'üéâ Tutti i test completati! Sistema pronto per l\'uso.');
        }

        // Test automatico all'avvio
        window.addEventListener('load', () => {
            setTimeout(runAllTests, 1000);
        });
    </script>
</body>
</html>